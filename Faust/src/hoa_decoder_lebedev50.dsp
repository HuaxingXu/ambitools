declare name        "HOA Decoder up to order 5 for 50 nodes Lebedev grid";
declare version     "1.0";
declare author      "Pierre Lecomte";
declare license     "GPL";
declare copyright   "(c) Pierre Lecomte 2014";

import("math.lib");
import("music.lib");
import("lib/ymn.lib");
import("lib/nfc.lib");
import("lib/lebedev.lib");

//Basic decoder (mode-matching) for Lebedev grid with 50 nodes, working up to order 5 [1]. 
//Possibility to choose with or without near-field compensation.
//[1] Lecomte, P., Gauthier, P.-A., Langrenne, C., Garcia, A., & Berry, A. (2015). On the use of a Lebedev grid for Ambisonics. In Audio Engineering Society Convention 139. New York.
//[2] Lecomte, P., & Gauthier, P.-A. (2015). Real-Time 3D Ambisonics using Faust, Processing, Pure Data, And OSC. In 15th International Conference on Digital Audio Effects (DAFx-15). Trondheim, Norway.

nf=vgroup("NFC",checkbox("Yes"));
// Spherical restitution speaker layout radius r2 is needeed to stabilize near-field filters, see [1]
r2 = nentry("Speakers Radius", 1.07, 0.5, 10, 0.01);

vmeter(x)		= attach(x, envelop(x) : vbargraph("[unit:dB]", -70, 6));
// vmeter2 produces an osc alias and send the value of the bargraph on this alias when -xmit 2 is used at execution time
vmeter2(x,i) 		= x<:attach(x, envelop(x) : vbargraph("[unit:dB][osc:/output%i]", -70, 6));
envelop			= abs : max(db2linear(-70)) : linear2db : min(6)  : max ~ -(80.0/SR);

// Volume controler : CAUTION with maximal value (60 dB!) it's to compensate the attenuation of the microphone radial filters.
smooth(c)       = *(1-c) : +~*(c);
volin             = vgroup("Inputs Gain",vslider("[unit:dB][osc:/levelin -10 60]", 0, -10, 60, 0.1) : db2linear : smooth(0.999));
volout             = vgroup("Outputs Gain",vslider("[unit:dB][osc:/levelout -10 60]", 0, -10, 60, 0.1) : db2linear : smooth(0.999));

id(x,delta) =  vgroup("%2a",vmeter2(_,a)) with{
a = x+1+delta;};

idmute(x,delta) =  vgroup("%2a",_*(1-checkbox("Mute")):vmeter) with{
a = x+1+delta;};

meterm(m) = par(i,2*m+1,hgroup("%m",_*(1-checkbox("Mute")):idmute(i,m*m-1)));

matrix(n,m) = bus(n):vgroup("[4]B-Format",hgroup("[5]",meterm(0),meterm(1),meterm(2),meterm(3)),hgroup("[6]",meterm(4),meterm(5)))<:par(i,m,buswg(row(i)):>_*(volout));

// When near-field compensation is activated, multiplication by 4*PI*r2 to have the correct gain, see [2]
selecteur=hgroup("[3]",bus(36)<:((par(i,36,*(nf*volin*4*PI*r2)):(_,par(i,3,nfc1(r2)),par(i,5,nfc2(r2)),par(i,7,nfc3(r2)),par(i,9,nfc4(r2)),par(i,11,nfc5(r2)))),par(i,36,*((1-nf)*volin))):>bus(36));

process=vgroup("[1]HOA decoder on Lebedev 50 nodes grid",hgroup("[2]",selecteur:matrix(36,50)):vgroup("[7]Outputs",hgroup("[8]",par(i,25,id(i,0))),hgroup("[9]",par(i,25,id(i,25)))));

//Analytic decoder matrix Wlebedev.YLebedev [1]
//Vector of weighted spherical harmonics : spherical harmonics times the speaker weight for weighet quadrature rules [1]
wy5(t,d,g)=(y0(t,d)*g,y1(t,d)*g,y2(t,d)*g,y3(t,d)*g,y4(t,d)*g,y5(t,d)*g,y6(t,d)*g,y7(t,d)*g,y8(t,d)*g,y9(t,d)*g,y10(t,d)*g,y11(t,d)*g,y12(t,d)*g,y13(t,d)*g,y14(t,d)*g,y15(t,d)*g,y16(t,d)*g,y17(t,d)*g,y18(t,d)*g,y19(t,d)*g,y20(t,d)*g,y21(t,d)*g,y22(t,d)*g,y23(t,d)*g,y24(t,d)*g,y25(t,d)*g,y26(t,d)*g,y27(t,d)*g,y28(t,d)*g,y29(t,d)*g,y30(t,d)*g,y31(t,d)*g,y32(t,d)*g,y33(t,d)*g,y34(t,d)*g,y35(t,d)*g);

row(i)=wy5(azimuth(i),elevation(i),weight5(i));

//a(0)=(0.0126984, 0, 0.0219943, 0, 0, 0, 0.0283945, 0, 0, 0, 0, 0, 0.0335968, 0, 0, 0, 0, 0, 0, 0, 0.0380952, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0421159, 0, 0, 0, 0, 0);

//a(1)=(0.0126984, 0, 0, 0.0219943, 0, 0, -0.0141973, 0, 0.0245904, 0, 0, 0, 0, -0.0205738, 0, 0.0265606, 0, 0, 0, 0, 0.0142857, 0, -0.0212959, 0, 0.0281718, 0, 0, 0, 0, 0, 0, 0.0203893, 0, -0.0220229, 0, 0.0295468);

//a(2)=(0.0126984, 0.0219943, 0, 0, 0, 0, -0.0141973, 0, -0.0245904, -0.0265606, 0, -0.0205738, 0, 0, 0, 0, 0, 0, 0, 0, 0.0142857, 0, 0.0212959, 0, 0.0281718, 0.0295468, 0, 0.0220229, 0, 0.0203893, 0, 0, 0, 0, 0, 0);

//a(3)=(0.0126984, 0, 0, -0.0219943, 0, 0, -0.0141973, 0, 0.0245904, 0, 0, 0, 0, 0.0205738, 0, -0.0265606, 0, 0, 0, 0, 0.0142857, 0, -0.0212959, 0, 0.0281718, 0, 0, 0, 0, 0, 0, -0.0203893, 0, 0.0220229, 0, -0.0295468);

//a(4)=(0.0126984, -0.0219943, 0, 0, 0, 0, -0.0141973, 0, -0.0245904, 0.0265606, 0, 0.0205738, 0, 0, 0, 0, 0, 0, 0, 0, 0.0142857, 0, 0.0212959, 0, 0.0281718, -0.0295468, 0, -0.0220229, 0, -0.0203893, 0, 0, 0, 0, 0, 0);

//a(5)=(0.0126984, 0, -0.0219943, 0, 0, 0, 0.0283945, 0, 0, 0, 0, 0, -0.0335968, 0, 0, 0, 0, 0, 0, 0, 0.0380952, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.0421159, 0, 0, 0, 0, 0);

//a(6)=(0.022575, 0, 0.0276486, 0.0276486, 0, 0, 0.0126198, 0.0437162, 0.0218581, 0, 0, 0, -0.0105585, 0.0387943, 0.0408928, 0.0166944, 0, 0, 0, 0, -0.0275132, 0.0133853, 0.0473242, 0.0354142, 0.0125208, 0, 0, 0, 0, 0, -0.0281259, -0.0192232, 0.0339065, 0.0484479, 0.0293639, 0.00928568);

//a(7)=(0.022575, 0.0276486, 0.0276486, 0, 0, 0.0437162, 0.0126198, 0, -0.0218581, -0.0166944, 0, 0.0387943, -0.0105585, 0, -0.0408928, 0, 0, -0.0354142, 0, 0.0133853, -0.0275132, 0, -0.0473242, 0, 0.0125208, 0.00928568, 0, -0.0484479, 0, -0.0192232, -0.0281259, 0, -0.0339065, 0, 0.0293639, 0);

//a(8)=(0.022575, 0, 0.0276486, -0.0276486, 0, 0, 0.0126198, -0.0437162, 0.0218581, 0, 0, 0, -0.0105585, -0.0387943, 0.0408928, -0.0166944, 0, 0, 0, 0, -0.0275132, -0.0133853, 0.0473242, -0.0354142, 0.0125208, 0, 0, 0, 0, 0, -0.0281259, 0.0192232, 0.0339065, -0.0484479, 0.0293639, -0.00928568);

//a(9)=(0.022575, -0.0276486, 0.0276486, 0, 0, -0.0437162, 0.0126198, 0, -0.0218581, 0.0166944, 0, -0.0387943, -0.0105585, 0, -0.0408928, 0, 0, 0.0354142, 0, -0.0133853, -0.0275132, 0, -0.0473242, 0, 0.0125208, -0.00928568, 0, 0.0484479, 0, 0.0192232, -0.0281259, 0, -0.0339065, 0, 0.0293639, 0);

//a(10)=(0.022575, 0.0276486, 0, 0.0276486, 0.0437162, 0, -0.0252396, 0, 0, 0.0333888, 0, -0.0258629, 0, -0.0258629, 0, -0.0333888, 0, 0, -0.0378594, 0, 0.0253968, 0, 0, 0, -0.0500832, -0.0371427, 0, -0.0276845, 0, 0.0256309, 0, 0.0256309, 0, 0.0276845, 0, -0.0371427);

//a(11)=(0.022575, 0.0276486, 0, -0.0276486, -0.0437162, 0, -0.0252396, 0, 0, 0.0333888, 0, -0.0258629, 0, 0.0258629, 0, 0.0333888, 0, 0, 0.0378594, 0, 0.0253968, 0, 0, 0, -0.0500832, -0.0371427, 0, -0.0276845, 0, 0.0256309, 0, -0.0256309, 0, -0.0276845, 0, 0.0371427);

//a(12)=(0.022575, -0.0276486, 0, -0.0276486, 0.0437162, 0, -0.0252396, 0, 0, -0.0333888, 0, 0.0258629, 0, 0.0258629, 0, 0.0333888, 0, 0, -0.0378594, 0, 0.0253968, 0, 0, 0, -0.0500832, 0.0371427, 0, 0.0276845, 0, -0.0256309, 0, -0.0256309, 0, -0.0276845, 0, 0.0371427);

//a(13)=(0.022575, -0.0276486, 0, 0.0276486, -0.0437162, 0, -0.0252396, 0, 0, -0.0333888, 0, 0.0258629, 0, -0.0258629, 0, -0.0333888, 0, 0, 0.0378594, 0, 0.0253968, 0, 0, 0, -0.0500832, 0.0371427, 0, 0.0276845, 0, -0.0256309, 0, 0.0256309, 0, 0.0276845, 0, -0.0371427);

//a(14)=(0.022575, 0, -0.0276486, 0.0276486, 0, 0, 0.0126198, -0.0437162, 0.0218581, 0, 0, 0, 0.0105585, 0.0387943, -0.0408928, 0.0166944, 0, 0, 0, 0, -0.0275132, -0.0133853, 0.0473242, -0.0354142, 0.0125208, 0, 0, 0, 0, 0, 0.0281259, -0.0192232, -0.0339065, 0.0484479, -0.0293639, 0.00928568);

//a(15)=(0.022575, 0.0276486, -0.0276486, 0, 0, -0.0437162, 0.0126198, 0, -0.0218581, -0.0166944, 0, 0.0387943, 0.0105585, 0, 0.0408928, 0, 0, 0.0354142, 0, -0.0133853, -0.0275132, 0, -0.0473242, 0, 0.0125208, 0.00928568, 0, -0.0484479, 0, -0.0192232, 0.0281259, 0, 0.0339065, 0, -0.0293639, 0);

//a(16)=(0.022575, 0, -0.0276486, -0.0276486, 0, 0, 0.0126198, 0.0437162, 0.0218581, 0, 0, 0, 0.0105585, -0.0387943, -0.0408928, -0.0166944, 0, 0, 0, 0, -0.0275132, 0.0133853, 0.0473242, 0.0354142, 0.0125208, 0, 0, 0, 0, 0, 0.0281259, 0.0192232, -0.0339065, -0.0484479, -0.0293639, -0.00928568);

//a(17)=(0.022575, -0.0276486, -0.0276486, 0, 0, 0.0437162, 0.0126198, 0, -0.0218581, 0.0166944, 0, -0.0387943, 0.0105585, 0, 0.0408928, 0, 0, -0.0354142, 0, 0.0133853, -0.0275132, 0, -0.0473242, 0, 0.0125208, -0.00928568, 0, 0.0484479, 0, 0.0192232, 0.0281259, 0, 0.0339065, 0, -0.0293639, 0);

//a(18)=(0.0210938, 0.0210938, 0.0210938, 0.0210938, 0.0272319, 0.0272319, 0, 0.0272319, 0, 0.0169821, 0.0415974, 0.0131543, -0.0214808, 0.0131543, 0, -0.0169821, 0, 0.0294138, 0.0314447, -0.0111174, -0.0246094, -0.0111174, 0, -0.0294138, -0.0207987, -0.0125942, 0, 0.0281616, 0, -0.0260726, -0.00673191, -0.0260726, 0, -0.0281616, -0.0398265, -0.0125942);

//a(19)=(0.0210938, 0.0210938, 0.0210938, -0.0210938, -0.0272319, 0.0272319, 0, -0.0272319, 0, 0.0169821, -0.0415974, 0.0131543, -0.0214808, -0.0131543, 0, 0.0169821, 0, 0.0294138, -0.0314447, -0.0111174, -0.0246094, 0.0111174, 0, 0.0294138, -0.0207987, -0.0125942, 0, 0.0281616, 0, -0.0260726, -0.00673191, 0.0260726, 0, 0.0281616, -0.0398265, 0.0125942);

//a(20)=(0.0210938, -0.0210938, 0.0210938, -0.0210938, 0.0272319, -0.0272319, 0, -0.0272319, 0, -0.0169821, 0.0415974, -0.0131543, -0.0214808, -0.0131543, 0, 0.0169821, 0, -0.0294138, 0.0314447, 0.0111174, -0.0246094, 0.0111174, 0, 0.0294138, -0.0207987, 0.0125942, 0, -0.0281616, 0, 0.0260726, -0.00673191, 0.0260726, 0, 0.0281616, -0.0398265, 0.0125942);

//a(21)=(0.0210938, -0.0210938, 0.0210938, 0.0210938, -0.0272319, -0.0272319, 0, 0.0272319, 0, -0.0169821, -0.0415974, -0.0131543, -0.0214808, 0.0131543, 0, -0.0169821, 0, -0.0294138, -0.0314447, 0.0111174, -0.0246094, -0.0111174, 0, -0.0294138, -0.0207987, 0.0125942, 0, -0.0281616, 0, 0.0260726, -0.00673191, -0.0260726, 0, -0.0281616, -0.0398265, -0.0125942);

//a(22)=(0.0210938, 0.0210938, -0.0210938, 0.0210938, 0.0272319, -0.0272319, 0, -0.0272319, 0, 0.0169821, -0.0415974, 0.0131543, 0.0214808, 0.0131543, 0, -0.0169821, 0, -0.0294138, 0.0314447, 0.0111174, -0.0246094, 0.0111174, 0, 0.0294138, -0.0207987, -0.0125942, 0, 0.0281616, 0, -0.0260726, 0.00673191, -0.0260726, 0, -0.0281616, 0.0398265, -0.0125942);

//a(23)=(0.0210938, 0.0210938, -0.0210938, -0.0210938, -0.0272319, -0.0272319, 0, 0.0272319, 0, 0.0169821, 0.0415974, 0.0131543, 0.0214808, -0.0131543, 0, 0.0169821, 0, -0.0294138, -0.0314447, 0.0111174, -0.0246094, -0.0111174, 0, -0.0294138, -0.0207987, -0.0125942, 0, 0.0281616, 0, -0.0260726, 0.00673191, 0.0260726, 0, 0.0281616, 0.0398265, 0.0125942);

//a(24)=(0.0210938, -0.0210938, -0.0210938, -0.0210938, 0.0272319, 0.0272319, 0, 0.0272319, 0, -0.0169821, -0.0415974, -0.0131543, 0.0214808, -0.0131543, 0, 0.0169821, 0, 0.0294138, 0.0314447, -0.0111174, -0.0246094, -0.0111174, 0, -0.0294138, -0.0207987, 0.0125942, 0, -0.0281616, 0, 0.0260726, 0.00673191, 0.0260726, 0, 0.0281616, 0.0398265, 0.0125942);

//a(25)=(0.0210938, -0.0210938, -0.0210938, 0.0210938, -0.0272319, 0.0272319, 0, -0.0272319, 0, -0.0169821, 0.0415974, -0.0131543, 0.0214808, 0.0131543, 0, -0.0169821, 0, 0.0294138, -0.0314447, -0.0111174, -0.0246094, 0.0111174, 0, 0.0294138, -0.0207987, 0.0125942, 0, -0.0281616, 0, 0.0260726, 0.00673191, -0.0260726, 0, -0.0281616, 0.0398265, -0.0125942);

//a(26)=(0.0201733, 0.0105352, 0.0316055, 0.0105352, 0.00710282, 0.0213085, 0.0328065, 0.0213085, 0, 0.00231317, 0.0169983, 0.0304602, 0.0263336, 0.0304602, 0, -0.00231317, 0, 0.00627703, 0.0290785, 0.0355874, 0.0142547, 0.0355874, 0, -0.00627703, -0.00147951, -0.000467862, 0, 0.0122053, 0.0410014, 0.0351912, -0.000750248, 0.0351912, 0, -0.0122053, -0.00443853, -0.000467862);

//a(27)=(0.0201733, 0.0105352, 0.0316055, -0.0105352, -0.00710282, 0.0213085, 0.0328065, -0.0213085, 0, 0.00231317, -0.0169983, 0.0304602, 0.0263336, -0.0304602, 0, 0.00231317, 0, 0.00627703, -0.0290785, 0.0355874, 0.0142547, -0.0355874, 0, 0.00627703, -0.00147951, -0.000467862, 0, 0.0122053, -0.0410014, 0.0351912, -0.000750248, -0.0351912, 0, 0.0122053, -0.00443853, 0.000467862);

//a(28)=(0.0201733, -0.0105352, 0.0316055, -0.0105352, 0.00710282, -0.0213085, 0.0328065, -0.0213085, 0, -0.00231317, 0.0169983, -0.0304602, 0.0263336, -0.0304602, 0, 0.00231317, 0, -0.00627703, 0.0290785, -0.0355874, 0.0142547, -0.0355874, 0, 0.00627703, -0.00147951, 0.000467862, 0, -0.0122053, 0.0410014, -0.0351912, -0.000750248, -0.0351912, 0, 0.0122053, -0.00443853, 0.000467862);

//a(29)=(0.0201733, -0.0105352, 0.0316055, 0.0105352, -0.00710282, -0.0213085, 0.0328065, 0.0213085, 0, -0.00231317, -0.0169983, -0.0304602, 0.0263336, 0.0304602, 0, -0.00231317, 0, -0.00627703, -0.0290785, -0.0355874, 0.0142547, 0.0355874, 0, -0.00627703, -0.00147951, 0.000467862, 0, -0.0122053, -0.0410014, -0.0351912, -0.000750248, 0.0351912, 0, -0.0122053, -0.00443853, -0.000467862);

//a(30)=(0.0201733, 0.0105352, 0.0105352, 0.0316055, 0.0213085, 0.00710282, -0.0164033, 0.0213085, 0.0284113, 0.0300712, 0.0169983, -0.00537532, -0.0204817, -0.016126, 0.0226644, 0.0208185, 0.0355082, 0.0272004, -0.00671042, -0.0102808, 0.00425141, -0.0308424, -0.00894723, 0.0188311, 0.0103566, 0.0369611, 0.0355082, -0.00453341, -0.0205007, -0.000968566, 0.023091, -0.0029057, -0.0273342, -0.00313851, 0.0103566, -0.00140359);

//a(31)=(0.0201733, 0.0316055, 0.0105352, 0.0105352, 0.0213085, 0.0213085, -0.0164033, 0.00710282, -0.0284113, -0.0208185, 0.0169983, -0.016126, -0.0204817, -0.00537532, -0.0226644, -0.0300712, -0.0355082, -0.0188311, -0.00671042, -0.0308424, 0.00425141, -0.0102808, 0.00894723, -0.0272004, 0.0103566, -0.00140359, -0.0355082, 0.00313851, -0.0205007, -0.0029057, 0.023091, -0.000968566, 0.0273342, 0.00453341, 0.0103566, 0.0369611);

//a(32)=(0.0201733, 0.0316055, 0.0105352, -0.0105352, -0.0213085, 0.0213085, -0.0164033, -0.00710282, -0.0284113, -0.0208185, -0.0169983, -0.016126, -0.0204817, 0.00537532, -0.0226644, 0.0300712, 0.0355082, -0.0188311, 0.00671042, -0.0308424, 0.00425141, 0.0102808, 0.00894723, 0.0272004, 0.0103566, -0.00140359, 0.0355082, 0.00313851, 0.0205007, -0.0029057, 0.023091, 0.000968566, 0.0273342, -0.00453341, 0.0103566, -0.0369611);

//a(33)=(0.0201733, 0.0105352, 0.0105352, -0.0316055, -0.0213085, 0.00710282, -0.0164033, -0.0213085, 0.0284113, 0.0300712, -0.0169983, -0.00537532, -0.0204817, 0.016126, 0.0226644, -0.0208185, -0.0355082, 0.0272004, 0.00671042, -0.0102808, 0.00425141, 0.0308424, -0.00894723, -0.0188311, 0.0103566, 0.0369611, -0.0355082, -0.00453341, 0.0205007, -0.000968566, 0.023091, 0.0029057, -0.0273342, 0.00313851, 0.0103566, 0.00140359);

//a(34)=(0.0201733, -0.0105352, 0.0105352, -0.0316055, 0.0213085, -0.00710282, -0.0164033, -0.0213085, 0.0284113, -0.0300712, 0.0169983, 0.00537532, -0.0204817, 0.016126, 0.0226644, -0.0208185, 0.0355082, -0.0272004, -0.00671042, 0.0102808, 0.00425141, 0.0308424, -0.00894723, -0.0188311, 0.0103566, -0.0369611, 0.0355082, 0.00453341, -0.0205007, 0.000968566, 0.023091, 0.0029057, -0.0273342, 0.00313851, 0.0103566, 0.00140359);

//a(35)=(0.0201733, -0.0316055, 0.0105352, -0.0105352, 0.0213085, -0.0213085, -0.0164033, -0.00710282, -0.0284113, 0.0208185, 0.0169983, 0.016126, -0.0204817, 0.00537532, -0.0226644, 0.0300712, -0.0355082, 0.0188311, -0.00671042, 0.0308424, 0.00425141, 0.0102808, 0.00894723, 0.0272004, 0.0103566, 0.00140359, -0.0355082, -0.00313851, -0.0205007, 0.0029057, 0.023091, 0.000968566, 0.0273342, -0.00453341, 0.0103566, -0.0369611);

//a(36)=(0.0201733, -0.0316055, 0.0105352, 0.0105352, -0.0213085, -0.0213085, -0.0164033, 0.00710282, -0.0284113, 0.0208185, -0.0169983, 0.016126, -0.0204817, -0.00537532, -0.0226644, -0.0300712, 0.0355082, 0.0188311, 0.00671042, 0.0308424, 0.00425141, -0.0102808, 0.00894723, -0.0272004, 0.0103566, 0.00140359, 0.0355082, -0.00313851, 0.0205007, 0.0029057, 0.023091, -0.000968566, 0.0273342, 0.00453341, 0.0103566, 0.0369611);

//a(37)=(0.0201733, -0.0105352, 0.0105352, 0.0316055, -0.0213085, -0.00710282, -0.0164033, 0.0213085, 0.0284113, -0.0300712, -0.0169983, 0.00537532, -0.0204817, -0.016126, 0.0226644, 0.0208185, -0.0355082, -0.0272004, 0.00671042, 0.0102808, 0.00425141, -0.0308424, -0.00894723, 0.0188311, 0.0103566, -0.0369611, -0.0355082, 0.00453341, 0.0205007, 0.000968566, 0.023091, -0.0029057, -0.0273342, -0.00313851, 0.0103566, -0.00140359);

//a(38)=(0.0201733, 0.0105352, -0.0105352, 0.0316055, 0.0213085, -0.00710282, -0.0164033, -0.0213085, 0.0284113, 0.0300712, -0.0169983, -0.00537532, 0.0204817, -0.016126, -0.0226644, 0.0208185, 0.0355082, -0.0272004, -0.00671042, 0.0102808, 0.00425141, 0.0308424, -0.00894723, -0.0188311, 0.0103566, 0.0369611, -0.0355082, -0.00453341, 0.0205007, -0.000968566, -0.023091, -0.0029057, 0.0273342, -0.00313851, -0.0103566, -0.00140359);

//a(39)=(0.0201733, 0.0316055, -0.0105352, 0.0105352, 0.0213085, -0.0213085, -0.0164033, -0.00710282, -0.0284113, -0.0208185, -0.0169983, -0.016126, 0.0204817, -0.00537532, 0.0226644, -0.0300712, -0.0355082, 0.0188311, -0.00671042, 0.0308424, 0.00425141, 0.0102808, 0.00894723, 0.0272004, 0.0103566, -0.00140359, 0.0355082, 0.00313851, 0.0205007, -0.0029057, -0.023091, -0.000968566, -0.0273342, 0.00453341, -0.0103566, 0.0369611);

//a(40)=(0.0201733, 0.0316055, -0.0105352, -0.0105352, -0.0213085, -0.0213085, -0.0164033, 0.00710282, -0.0284113, -0.0208185, 0.0169983, -0.016126, 0.0204817, 0.00537532, 0.0226644, 0.0300712, 0.0355082, 0.0188311, 0.00671042, 0.0308424, 0.00425141, -0.0102808, 0.00894723, -0.0272004, 0.0103566, -0.00140359, -0.0355082, 0.00313851, -0.0205007, -0.0029057, -0.023091, 0.000968566, -0.0273342, -0.00453341, -0.0103566, -0.0369611);

//a(41)=(0.0201733, 0.0105352, -0.0105352, -0.0316055, -0.0213085, -0.00710282, -0.0164033, 0.0213085, 0.0284113, 0.0300712, 0.0169983, -0.00537532, 0.0204817, 0.016126, -0.0226644, -0.0208185, -0.0355082, -0.0272004, 0.00671042, 0.0102808, 0.00425141, -0.0308424, -0.00894723, 0.0188311, 0.0103566, 0.0369611, 0.0355082, -0.00453341, -0.0205007, -0.000968566, -0.023091, 0.0029057, 0.0273342, 0.00313851, -0.0103566, 0.00140359);

//a(42)=(0.0201733, -0.0105352, -0.0105352, -0.0316055, 0.0213085, 0.00710282, -0.0164033, 0.0213085, 0.0284113, -0.0300712, -0.0169983, 0.00537532, 0.0204817, 0.016126, -0.0226644, -0.0208185, 0.0355082, 0.0272004, -0.00671042, -0.0102808, 0.00425141, -0.0308424, -0.00894723, 0.0188311, 0.0103566, -0.0369611, -0.0355082, 0.00453341, 0.0205007, 0.000968566, -0.023091, 0.0029057, 0.0273342, 0.00313851, -0.0103566, 0.00140359);

//a(43)=(0.0201733, -0.0316055, -0.0105352, -0.0105352, 0.0213085, 0.0213085, -0.0164033, 0.00710282, -0.0284113, 0.0208185, -0.0169983, 0.016126, 0.0204817, 0.00537532, 0.0226644, 0.0300712, -0.0355082, -0.0188311, -0.00671042, -0.0308424, 0.00425141, -0.0102808, 0.00894723, -0.0272004, 0.0103566, 0.00140359, 0.0355082, -0.00313851, 0.0205007, 0.0029057, -0.023091, 0.000968566, -0.0273342, -0.00453341, -0.0103566, -0.0369611);

//a(44)=(0.0201733, -0.0316055, -0.0105352, 0.0105352, -0.0213085, 0.0213085, -0.0164033, -0.00710282, -0.0284113, 0.0208185, 0.0169983, 0.016126, 0.0204817, -0.00537532, 0.0226644, -0.0300712, 0.0355082, -0.0188311, 0.00671042, -0.0308424, 0.00425141, 0.0102808, 0.00894723, 0.0272004, 0.0103566, 0.00140359, -0.0355082, -0.00313851, -0.0205007, 0.0029057, -0.023091, -0.000968566, -0.0273342, 0.00453341, -0.0103566, 0.0369611);

//a(45)=(0.0201733, -0.0105352, -0.0105352, 0.0316055, -0.0213085, 0.00710282, -0.0164033, -0.0213085, 0.0284113, -0.0300712, 0.0169983, 0.00537532, 0.0204817, -0.016126, -0.0226644, 0.0208185, -0.0355082, 0.0272004, 0.00671042, -0.0102808, 0.00425141, 0.0308424, -0.00894723, -0.0188311, 0.0103566, -0.0369611, 0.0355082, 0.00453341, -0.0205007, 0.000968566, -0.023091, -0.0029057, 0.0273342, -0.00313851, -0.0103566, -0.00140359);

//a(46)=(0.0201733, 0.0105352, -0.0316055, 0.0105352, 0.00710282, -0.0213085, 0.0328065, -0.0213085, 0, 0.00231317, -0.0169983, 0.0304602, -0.0263336, 0.0304602, 0, -0.00231317, 0, -0.00627703, 0.0290785, -0.0355874, 0.0142547, -0.0355874, 0, 0.00627703, -0.00147951, -0.000467862, 0, 0.0122053, -0.0410014, 0.0351912, 0.000750248, 0.0351912, 0, -0.0122053, 0.00443853, -0.000467862);

//a(47)=(0.0201733, 0.0105352, -0.0316055, -0.0105352, -0.00710282, -0.0213085, 0.0328065, 0.0213085, 0, 0.00231317, 0.0169983, 0.0304602, -0.0263336, -0.0304602, 0, 0.00231317, 0, -0.00627703, -0.0290785, -0.0355874, 0.0142547, 0.0355874, 0, -0.00627703, -0.00147951, -0.000467862, 0, 0.0122053, 0.0410014, 0.0351912, 0.000750248, -0.0351912, 0, 0.0122053, 0.00443853, 0.000467862);

//a(48)=(0.0201733, -0.0105352, -0.0316055, -0.0105352, 0.00710282, 0.0213085, 0.0328065, 0.0213085, 0, -0.00231317, -0.0169983, -0.0304602, -0.0263336, -0.0304602, 0, 0.00231317, 0, 0.00627703, 0.0290785, 0.0355874, 0.0142547, 0.0355874, 0, -0.00627703, -0.00147951, 0.000467862, 0, -0.0122053, -0.0410014, -0.0351912, 0.000750248, -0.0351912, 0, 0.0122053, 0.00443853, 0.000467862);

//a(49)=(0.0201733, -0.0105352, -0.0316055, 0.0105352, -0.00710282, 0.0213085, 0.0328065, -0.0213085, 0, -0.00231317, 0.0169983, -0.0304602, -0.0263336, 0.0304602, 0, -0.00231317, 0, 0.00627703, -0.0290785, 0.0355874, 0.0142547, -0.0355874, 0, 0.00627703, -0.00147951, 0.000467862, 0, -0.0122053, 0.0410014, -0.0351912, 0.000750248, 0.0351912, 0, -0.0122053, 0.00443853, -0.000467862);