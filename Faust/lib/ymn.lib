declare name        "Spherical Harmonics up to order 5";
declare version     "1.0";
declare author      "Pierre Lecomte";
declare license     "GPL";
declare copyright   "(c) Pierre Lecomte 2014";

import("math.lib");

//ORDER 0
y001(theta,delta) = _;
LegendreP0(x) = 1;

//ORDER 1
y111(theta,delta) = sqrt(3)*cos(delta)*cos(theta)*_;
y11m1(theta,delta) = sqrt(3)*cos(delta)*sin(theta)*_;
y101(theta,delta) = sqrt(3)*sin(delta)*_;
LegendreP1(x) = 3*x;

//ORDRE 2
y221(theta,delta) = 0.5*sqrt(15)*cos(delta)^2*cos(2*theta)*_;
y22m1(theta,delta) = sqrt(15)*cos(delta)^2*cos(theta)*sin(theta)*_;
y211(theta,delta) = sqrt(15)*cos(delta)*cos(theta)*sin(delta)*_;
y21m1(theta,delta) = sqrt(15)*cos(delta)*sin(delta)*sin(theta)*_;
y201(theta,delta) = 0.5*sqrt(5)*(-1+3*sin(delta)^2)*_;
LegendreP2(x) = 2.5*(-1 + 3*x^2);

//ORDRE 3
y331(theta,delta) = 0.5*sqrt(17.5)*(cos(delta)^2)^(1.5)*cos(3*theta)*_;
y33m1(theta,delta) = 0.5*sqrt(17.5)*(cos(delta)^2)^(1.5)*sin(3*theta)*_;
y321(theta,delta) = 0.5*sqrt(105)*cos(delta)^2*cos(2*theta)*sin(delta)*_;
y32m1(theta,delta) = sqrt(105)*cos(delta)^2*cos(theta)*sin(delta)*sin(theta)*_;
y311(theta,delta) = 0.125*sqrt(10.5)*(cos(delta)-5*cos(3*delta))*cos(theta)*_;
y31m1(theta,delta) = 0.125*sqrt(10.5)*(cos(delta)-5*cos(3*delta))*sin(theta)*_;
y301(theta,delta) = -0.25*sqrt(7)*(1+5*cos(2*delta))*sin(delta)*_;
LegendreP3(x) = 3.5*(-3*x + 5*x^3);

//ORDRE 4
y441(theta,delta) = 0.375*sqrt(35)*cos(delta)^4*cos(4*theta)*_;
y44m1(theta,delta) = 0.375*sqrt(35)*cos(delta)^4*sin(4*theta)*_;
y431(theta,delta) = 1.5*sqrt(17.5)*(cos(delta)^2)^(1.5)*cos(3*theta)*sin(delta)*_;
y43m1(theta,delta) = 1.5*sqrt(17.5)*(cos(delta)^2)^(1.5)*sin(delta)*sin(3*theta)*_;
y421(theta,delta) = -0.375*sqrt(5)*cos(delta)^2*(-5+7*cos(2*delta))*cos(2*theta)*_;
y42m1(theta,delta) = -0.375*sqrt(5)*cos(delta)^2*(-5+7*cos(2*delta))*sin(2*theta)*_;
y411(theta,delta) = 1.5*sqrt(2.5)*cos(delta)*cos(theta)*sin(delta)*(-3+7*sin(delta)^2)*_;
y41m1(theta,delta) = 1.5*sqrt(2.5)*cos(delta)*sin(delta)*(-3+7*sin(delta)^2)*sin(theta)*_;
y401(theta,delta) = 0.375*(3-30*sin(delta)^2+35*sin(delta)^4)*_;
LegendreP4(x) = 1.125*(3-30*x^2+35*x^4);

//ORDRE 5
y551(theta,delta) = 0.375*sqrt(38.5)*(cos(delta)^2)^(2.5)*cos(5*theta)*_;
y55m1(theta,delta) = 0.375*sqrt(38.5)*(cos(delta)^2)^(2.5)*sin(5*theta)*_;
y541(theta,delta) = 0.375*sqrt(385)*cos(delta)^4*cos(4*theta)*sin(delta)*_;
y54m1(theta,delta) = 0.375*sqrt(385)*cos(delta)^4*sin(delta)*sin(4*theta)*_;
y531(theta,delta) = 0.0625*sqrt(192.5)*(cos(delta)^2)^(1.5)*(7-9*cos(2*delta))*cos(3*theta)*_;
y53m1(theta,delta) = 0.0625*sqrt(192.5)*(cos(delta)^2)^(1.5)*(7-9*cos(2*delta))*sin(3*theta)*_;
y521(theta,delta) = 0.0625*sqrt(1155)*cos(delta)^2*cos(2*theta)*(5*sin(delta)-3*sin(3*delta))*_;
y52m1(theta,delta) = 0.0625*sqrt(1155)*cos(delta)^2*(5*sin(delta)-3*sin(3*delta))*sin(2*theta)*_;
y511(theta,delta) = 0.125*sqrt(165)*cos(delta)*cos(theta)*(1-14*sin(delta)^2+21*sin(delta)^4)*_;
y51m1(theta,delta) = 0.125*sqrt(165)*cos(delta)*(1-14*sin(delta)^2+21*sin(delta)^4)*sin(theta)*_;
y501(theta,delta) = 0.015625*sqrt(11)*(29+28*cos(2*delta)+63*cos(4*delta))*sin(delta)*_;
LegendreP5(x)=1.375*(15*x-70*x^3+63*x^5);

// Gamma
angle(t1,d1,t2,d2) = cos(d1)*cos(d2)*cos(t1-t2)+sin(d1)*sin(d2);